<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kuis Interaktif - Lahan Basah Hijau</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Fredoka&display=swap" rel="stylesheet">
  <style>
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Fredoka', sans-serif;
      background-color: #f0faff;
      overflow-x: hidden;
    }

    /* Navbar */
    .navbar-nav .nav-link {
      padding: 8px 16px;
      transition: all 0.3s ease;
      border-radius: 20px;
    }
    .navbar-nav .nav-link:hover {
      background-color: #f0f8ff;
      color: #0d6efd;
    }
    .navbar-nav .nav-link.active {
      background-color: #d1e7ff;
      color: #0d6efd;
    }

    /* Hero Section */
    .hero {
      background: linear-gradient(to bottom, #b3e9ff, #d1fce5);
      padding: 100px 20px 60px;
      text-align: center;
      position: relative;
      overflow: hidden;
      border-radius: 0 0 60px 60px;
      border: 4px solid rgba(255,255,255,0.6);
    }
    .hero-title {
      color: #035397;
      font-size: 3.2rem;
      font-weight: 700;
      text-shadow: 2px 2px #ffffff;
      position: relative;
    }
    .hero-subtitle {
      color: #0b6c5f;
      font-size: 1.25rem;
      margin-bottom: 20px;
      position: relative;
    }
    .main-button {
      background-color: #2e8b57;
      color: white;
      font-size: 1.2rem;
      padding: 12px 32px;
      border-radius: 40px;
      margin-top: 20px;
      transition: all 0.3s ease;
      margin-right: 20px;
    }
    .main-button:hover {
      background-color: #256b45;
    }
    .main-button2 {
      border: 1px solid #2e8b57;
      color: black;
      font-size: 1.2rem;
      padding: 12px 32px;
      border-radius: 40px;
      margin-top: 20px;
      transition: all 0.3s ease;
      margin-right: 20px;
    }
    .main-button2:hover {
      background-color: #256b45;
      color: white;
    }

    .bird { 
      position: absolute;
      top: 80px;
      left: -100px;
      width: 5%;
      animation: flyBird 10s linear infinite;
      animation-delay: 0s;
      z-index: 1;
    }

    .bird1 {
      position: absolute;
      top: 100px;
      left: -150px;
      width: 5%;
      animation: flyBird 15s linear infinite;
      animation-delay: 5s;
      z-index: 1;
    }

    .bird2 {
      position: absolute;
      top: 50px;
      left: -200px;
      width: 10%;
      animation: flyBird 20s linear infinite;
      animation-delay: 10s;
      z-index: 1;
    }

    .bird3 {
      position: absolute;
      top: 50px;
      left: -200px;
      width: 10%;
      animation: flyBird 25s linear infinite;
      animation-delay: 15s;
      z-index: 1;
    }

    .bird4 {
      position: absolute;
      top: 50px;
      left: -150px;
      width: 10%;
      animation: flyBird 20s linear infinite;
      animation-delay: 5s;
      z-index: 1;
    }

    .bird5 {
      position: absolute;
      top: 50px;
      left: -200px;
      width: 10%;
      animation: flyBird 15s linear infinite;
      animation-delay: 12s;
      z-index: 1;
    }
    
    @keyframes flyBird {
      0% { transform: translateX(0) rotate(0deg); }
      100% { transform: translateX(120vw) rotate(10deg); }
    }

    .cloud {
      position: absolute;
      top: -70px;
      left: 10%;
      width: 30%;
      animation: floatCloud 40s linear infinite;
    }
    .cloud2 {
      top: 60px;
      position: absolute;
      left: 60%;
      width: 30%;
      animation: floatCloud 40s linear infinite;
      animation-delay: 50s linear infinite;
    }

    @keyframes floatCloud {
      0% { transform: translateX(0); }
      100% { transform: translateX(100vw); }
    }

    .hero img.peneliti {
      position: absolute;
      left: 200px;
      bottom: 40px;
      max-height: 200px;
      width: auto;
      animation: swayPeneliti 4s ease-in-out infinite;
      z-index: 2;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    @keyframes swayPeneliti {
      0% { transform: rotate(0deg) translateY(0); }
      25% { transform: rotate(-2deg) translateY(2px); }
      50% { transform: rotate(0deg) translateY(0); }
      75% { transform: rotate(2deg) translateY(-2px); }
      100% { transform: rotate(0deg) translateY(0); }
    }

    @media (max-width: 768px) {
      .hero { 
        padding: 80px 20px 40px;}
      .hero-title { font-size: 2.2rem; }
      .hero-subtitle { font-size: 1rem; }
      .main-button { font-size: 1rem; padding: 10px 24px; }
      .main-button2 { font-size: 1rem; padding: 10px 24px; }
      .hero img.peneliti {display: none;}

  .cloud,
  .cloud2,
  .cloud3,
  .bird,
  .bird1 {
    margin-top: 80px;
  }
    }

    
  #mulaiKuis button {
    transition: all 0.3s ease;
  }
  #mulaiKuis button:hover {
    background-color: #d1e7ff;
  }

  #soalContainer{
    max-width: 800px;
  margin: 40px auto;
  padding: 30px;
  border-radius: 20px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
  animation: fadeIn 0.6s ease-in-out;
  }
   .container-kuis {
  max-width: 800px;
  margin: 40px auto;
  padding: 30px;
  animation: fadeIn 0.6s ease-in-out;
}
    .feedback {
  margin-top: 12px;
  font-size: 1rem;
  font-weight: bold;
}
    .benar {
      background-color: #d4edda;
      color: #155724;
    }
    .salah {
      background-color: #f8d7da;
      color: #721c24;
    }
    /* Warna latar dinamis berdasarkan level */
.level-mudah {
  background-color: #e6f7ff !important;
}
.level-sedang {
  background-color: #fff9e6 !important;
}
.level-sulit {
  background-color: #e08686 !important;
}
    #mulaiForm input {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
    #btnLanjut, #btnCobaLagi, #btnSelesai {
      background-color: #2c7a7b;
      color: white;
      border: none;
      align-content: center;
    }

    #btnLanjut:hover, #btnCobaLagi:hover {
      opacity: 0.9;
    }

    .btn-kuis {
      display: inline-block;
  font-size: 18px;
  font-weight: bold;
  padding: 12px 24px;
  margin-top: 16px;
  border: none;
  border-radius: 30px;
  cursor: pointer;
  background: linear-gradient(45deg, #57C5B6, #A5DD9B);
  color: white;
  transition: all 0.3s ease;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}
    .btn-kuis:hover {
      transform: scale(1.05);
  background: linear-gradient(45deg, #A5DD9B, #57C5B6);
}

.btn-kuis:active {
  transform: scale(0.95);
}
    /* Opsi jawaban */
#opsiJawaban button {
  display: block;
  width: 100%;
  font-size: 16px;
  border-radius: 20px;
  background-color: #fff;
  color: #333;
  border: 2px solid #57C5B6;
  transition: 0.2s ease-in-out;

  
}
#opsiJawaban button:hover {
   background-color: #57C5B6;
  color: white;
  transform: scale(1.05);
}
/* Judul soal */
#judulSoal {
  font-size: 1.4rem;
  font-weight: bold;
  margin-bottom: 10px;
}

/* Skor akhir */
#hasilContainer {
  background-color: #f0fff4;
  border: 2px dashed #66bb6a;
  padding: 20px;
  border-radius: 16px;
  text-align: center;
   animation: munculPelan 0.5s ease-in-out;
}

#btnCobaLagi {
  animation: munculPelan 0.5s ease-in-out;
}

/* Animasi muncul */
@keyframes munculPelan {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Tampilan pesan skor akhir */
#hasilContainer h2, #pesanHasil {
  color: black;
  font-weight: bold;
  text-align: center;
  font-family: 'Fredoka', sans-serif;
}

/* Animasi */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.centered-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.btnLeaderboard{
      color: black;
      border: 1px solid #2c7a7b;
}

.bg-pink {
  background-color: #ffb6c1 !important;
  color: white;
}

#notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background-color: #fff8dc;
  color: #333;
  padding: 12px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  font-size: 14px;
  z-index: 9999;
  transition: all 0.3s ease;
  border: 1px solid #ffe58f;
}


  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top" style="z-index: 1030;">
    <div class="container">
      <a class="navbar-brand fw-bold text-primary" href="/modul/modul.html">
        <img src="/modul/foto/logo.png" alt="Logo" width="60" class="me-2" />
        Lahan Basah Hijau
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav fw-semibold">
          <li class="nav-item"><a class="nav-link" href="/modul/modul.html">üè† Beranda</a></li>
          <li class="nav-item"><a class="nav-link active" href="/kuis/kuis.html">üß† Kuis</a></li>
          <li class="nav-item"><a class="nav-link" href="/simulasi/simulasi.html">üß™ Simulasi</a></li>
          <li class="nav-item"><a class="nav-link" href="/proyek/proyek.html">üí° Proyek</a></li>
          <li class="nav-item"><a class="nav-link" href="/leaderboard/leaderboard.html">üèÜ Papan Peringkat</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <img src="/modul/foto/daun1.png" class="bird" />
    <img src="/modul/foto/daun2.png" class="bird1" />
    <img src="/modul/foto/alat/7.png" class="bird2" />
    <img src="/modul/foto/alat/7.png" class="bird3" />
    <img src="/modul/foto/alat/8.png" class="bird4" />
    <img src="/modul/foto/alat/9.png" class="bird5" />
    <img src="/modul/foto/cloud1.png" class="cloud" />
    <img src="/modul/foto/cloud2.png" class="cloud2" />

    <h1 class="hero-title">Kuis Interaktif</h1>
    <p class="hero-subtitle">Uji pengetahuanmu tentang ekosistem lahan basah</p>
    <a href="#kuisContainer" class="btn main-button">Kerjakan Kuis</a>
    <a href="/leaderboard/leaderboard.html/#leaderboard" class="btn main-button2">Lihat Papan Peringkat</a><br>

    <img src="/modul/foto/kuis.png" class="peneliti" alt="Proyek" />
  </section>

 
  <div class="container-kuis" id="kuisContainer">
    <div id="mulaiForm" class=" centered-container">
      <p>Yuk, isi data dirimu dulu untuk mengerjakan kuis ya!</p>
      <input type="text" id="nama" placeholder="Nama lengkap: Luna">
      <input type="text" id="sekolah" placeholder="Nama sekolah: SMA Negeri 2 Banjarmasin">
      <button class="btn-kuis" onclick="mulaiKuis()">üöÄ Mulai Kuis</button>
    </div>

    <div id="soalContainer" style="display:none">
      <div id="infoLevel" class="alert alert-warning d-none text-center rounded-4 shadow-sm p-4 mt-3">
        <h5 class="fw-bold mb-3">üéØ Petunjuk Kuis Seru</h5>
        <div class="d-flex justify-content-around flex-wrap gap-3">
          <div class="p-3 rounded-3 bg-primary text-white" style="min-width: 150px;">
            <h6 class="mb-1">üîµ Level Mudah</h6>
            <small>4 soal pertama</small>
          </div>
          <div class="p-3 rounded-3 bg-pink text-white" style="background-color: #f06292 !important; min-width: 150px;">
            <h6 class="mb-1">üå∏ Level Sedang</h6>
            <small>4 soal berikutnya</small>
          </div>
          <div class="p-3 rounded-3 bg-danger text-white" style="min-width: 150px;">
            <h6 class="mb-1">üî• Level Sulit</h6>
            <small>4 soal terakhir</small>
          </div>
          <div class="p-3 rounded-3 bg-danger text-white" style="min-width: 150px;">
            <small>Tidak dapat kembali ke soal sebelumnya</small>
          </div>
        </div>
      </div>
      <p id="teksSoal" class="text-center"></p>
      <div id="opsiJawaban"></div>
      <p id="feedback" class="feedback text-center"></p>
      <div class=" centered-container"><button class="btn" id="btnLanjut" onclick="lanjutSoal()" style="display:none">Soal Berikutnya</button> </div>
      
    </div>
    
    <div id="hasilContainer" style="display:none">
      <h2>Skor Akhir:</h2>
      <p id="skorAkhir"></p>
      <p id="pesanHasil"></p>
      <button class="btn" id="btnCobaLagi" onclick="cobaLagi()" style="display:none">Coba Lagi</button>
      <br><a href="/leaderboard/leaderboard.html/#leaderboard" class="btn btnLeaderboard mt-2">Lihat Papan Peringkat</a>
    </div>
  </div>

  <div id="notifArea" class="position-fixed top-0 start-50 translate-middle-x w-100" style="z-index: 9999;"></div>

   <!--Musik-->
<audio id="bg-music" autoplay loop>
  <source src="/modul/sound/sound2.mp3" type="audio/mpeg">
</audio>

<!-- Tombol Musik -->
<button id="music-toggle"
        class="btn btn-light rounded-circle shadow position-fixed position-absolute d-flex align-items-center justify-content-center"
        style="bottom: 20px; right: 20px; width: 50px; height: 50px; z-index: 9999;"
        title="Nyalakan/Matikan Musik">
  <span id="music-icon">üîä</span>
</button>

<!-- Toast -->
<div id="music-toast"
     class="position-fixed bottom-0 end-0 mb-5 me-3 p-3 bg-white rounded shadow text-dark fw-semibold"
     style="z-index: 9999; display: none; transition: opacity 0.5s ease;">
  Musik Dimatikan
</div>

  <!-- Footer -->
  <footer class="bg-light text-center text-lg-start shadow-top bg-white">
  <div class="container py-4">

    <div class="row align-items-center">
      <div class="col-md-6 text-md-start text-center mb-3 mb-md-0">
        <h5 class="fw-bold text-primary">
          <img src="/modul/foto/logo.png" alt="Logo" width="60" class="me-2">
          Lahan Basah Hijau
        </h5>
        <p class="text-muted small mb-0">
          Aplikasi pembelajaran interaktif berbasis STEM untuk mengenal, menjaga, dan mencintai lahan basah.
        </p>
      </div>
      <div class="col-md-6 text-md-end text-center">
          <ul class="list-inline mb-0">
          <li class="list-inline-item mx-2"><a href="/modul/modul.html" class="text-decoration-none text-muted">Beranda</a></li>
          <li class="list-inline-item mx-2"><a href="/kuis/kuis.html" class="text-decoration-none text-muted">Kuis</a></li>
          <li class="list-inline-item mx-2"><a href="/simulasi/simulasi.html" class="text-decoration-none text-muted">Simulasi</a></li>
          <li class="list-inline-item mx-2"><a href="/proyek/proyek.html" class="text-decoration-none text-muted">Proyek</a></li>
          <li class="list-inline-item mx-2"><a href="/leaderboard/leaderboard.html" class="text-decoration-none text-muted">Papan Peringkat</a></li>
        </ul>
      </div>
    </div>

  </div>
  <div class="text-center bg-white py-3 border-top">
    <small class="text-muted">¬© 2025 Lahan Basah Hijau. Semua hak dilindungi.</small>
  </div>
</footer>

  <!-- Bootstrap & Script -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
 <script>
  
  const soalMudah = [
  {
    pertanyaan: "Apa itu lahan basah?",
    opsi: ["Daerah berair seperti rawa, danau, dan sungai", "Tanah yang tidak bisa ditanami", "Padang pasir", "Pegunungan"],
    jawaban: "Daerah berair seperti rawa, danau, dan sungai",
    penjelasan: "Lahan basah adalah daerah yang selalu tergenang air, seperti rawa, sungai, atau danau."
  },
  {
    pertanyaan: "Contoh tumbuhan yang hidup di lahan basah adalah...",
    opsi: ["Teratai", "Kaktus", "Pinus", "Anggrek"],
    jawaban: "Teratai",
    penjelasan: "Teratai tumbuh di air, sehingga cocok untuk lahan basah."
  },
  {
    pertanyaan: "Lahan basah sering ditemukan di...",
    opsi: ["Pantai", "Gunung", "Desa dan pinggir sungai", "Pabrik"],
    jawaban: "Desa dan pinggir sungai",
    penjelasan: "Lahan basah banyak terdapat di daerah pinggiran sungai atau rawa."
  },
  {
    pertanyaan: "Binatang yang sering hidup di lahan basah adalah...",
    opsi: ["Katak", "Ular gurun", "Harimau", "Kelinci"],
    jawaban: "Katak",
    penjelasan: "Katak suka hidup di tempat yang lembab dan berair seperti lahan basah."
  }
];

const soalSedang = [
  {
    pertanyaan: "Apa fungsi penting lahan basah?",
    opsi: ["Menjaga air tanah", "Tempat pengolahan sampah", "Menimbun limbah", "Tempat parkir kapal"],
    jawaban: "Menjaga air tanah",
    penjelasan: "Lahan basah membantu menyimpan air tanah dan menjaga ekosistem air."
  },
  {
    pertanyaan: "Mengapa lahan basah perlu dilestarikan?",
    opsi: ["Karena penting untuk satwa dan manusia", "Karena bisa dijadikan mall", "Karena tanahnya mahal", "Karena tidak berguna"],
    jawaban: "Karena penting untuk satwa dan manusia",
    penjelasan: "Lahan basah menjadi rumah bagi banyak satwa dan membantu kehidupan manusia."
  },
  {
    pertanyaan: "Jika lahan basah rusak, apa dampaknya?",
    opsi: ["Banjir lebih sering", "Harga makanan naik", "Musim hujan hilang", "Listrik padam"],
    jawaban: "Banjir lebih sering",
    penjelasan: "Lahan basah menyerap air, kalau rusak bisa menyebabkan banjir."
  },
  {
    pertanyaan: "Siapa yang bertanggung jawab menjaga lahan basah?",
    opsi: ["Semua orang", "Hanya pemerintah", "Petani saja", "Anak-anak saja"],
    jawaban: "Semua orang",
    penjelasan: "Semua warga punya peran menjaga lingkungan, termasuk lahan basah."
  }
];

const soalSulit = [
  {
    pertanyaan: "Apa ancaman utama terhadap lahan basah saat ini?",
    opsi: ["Alih fungsi lahan", "Banyak hujan", "Terbitnya matahari", "Serangan serangga"],
    jawaban: "Alih fungsi lahan",
    penjelasan: "Lahan basah sering dialihfungsikan jadi bangunan atau sawah."
  },
  {
    pertanyaan: "Contoh kegiatan manusia yang merusak lahan basah adalah...",
    opsi: ["Membuang sampah ke sungai", "Menanam pohon bakau", "Membersihkan rawa", "Membuat taman edukasi"],
    jawaban: "Membuang sampah ke sungai",
    penjelasan: "Sampah mencemari dan merusak ekosistem lahan basah."
  },
  {
    pertanyaan: "Bagaimana cara pelestarian lahan basah?",
    opsi: ["Reboisasi, edukasi, dan perlindungan kawasan", "Menutupnya dengan beton", "Mengubah jadi jalan tol", "Menebang seluruh tanaman"],
    jawaban: "Reboisasi, edukasi, dan perlindungan kawasan",
    penjelasan: "Upaya pelestarian dilakukan lewat reboisasi, edukasi, dan perlindungan habitat."
  },
  {
    pertanyaan: "Apa dampak global dari kerusakan lahan basah?",
    opsi: ["Perubahan iklim", "Harga bensin naik", "Musik pop menghilang", "Makanan terasa hambar"],
    jawaban: "Perubahan iklim",
    penjelasan: "Lahan basah menyimpan karbon, kerusakannya berkontribusi pada pemanasan global."
  }
];
  // üî• Konfigurasi Firebase
 const firebaseConfig = {
  apiKey: "AIzaSyDguvGwMNqADw8vC2877IDvoxmnTvj1txU",
  authDomain: "inovasi-stem-lahan-basah.firebaseapp.com",
  databaseURL: "https://inovasi-stem-lahan-basah-default-rtdb.firebaseio.com",
  projectId: "inovasi-stem-lahan-basah",
  storageBucket: "inovasi-stem-lahan-basah.appspot.com",
  messagingSenderId: "853863316290",
  appId: "1:853863316290:web:721e94519c84e725f1a6db"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();


// Variabel kuis
let indexSoal = 0;
let skor = 0;
let jawabanUser = [];
let seluruhSoal = [];

    
function acakArray(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

// Mulai Kuis
function mulaiKuis() {
  const nama = document.getElementById("nama").value.trim();
  const sekolah = document.getElementById("sekolah").value.trim();

  if (!nama || !sekolah) {
    showNotification("Nama dan sekolah harus diisi.", "danger");
    return;
  }

  const userId = `${nama.toLowerCase()}_${sekolah.toLowerCase()}`;
  db.ref(`kuis/${userId}`).once("value", (snapshot) => {
    if (snapshot.exists()) {
      showNotification("Kamu sudah pernah mengerjakan kuis.", "warning");
    } else {
      document.getElementById("mulaiForm").style.display = "none";
      document.getElementById("soalContainer").style.display = "block";
      document.getElementById("infoLevel").classList.remove("d-none");

      seluruhSoal = [...acakArray(soalMudah), ...acakArray(soalSedang), ...acakArray(soalSulit)];
      tampilkanSoal();
    }
  });
}

// Tampilkan Soal
function tampilkanSoal() {
  console.log("Menampilkan soal ke-", indexSoal);
  if (!seluruhSoal[indexSoal]) {
    showNotification("Soal tidak ditemukan!", "danger");
    return;
  }

  const soal = seluruhSoal[indexSoal];
  console.log(soal);

  const teksSoal = document.getElementById("teksSoal");
  const opsiJawaban = document.getElementById("opsiJawaban");
  const feedback = document.getElementById("feedback");

  teksSoal.innerHTML = `${soal.pertanyaan}`;
  opsiJawaban.innerHTML = "";
  feedback.innerHTML = "";
  document.getElementById("btnLanjut").style.display = "none";

  const soalBox = document.getElementById("soalContainer");
  soalBox.style.backgroundColor = indexSoal < 4 ? "#e3f2fd" : indexSoal < 8 ? "#fce4ec" : "#e08686";

  soal.opsi.forEach(pilihan => {
    const btn = document.createElement("button");
    btn.className = "btn btn-option m-2";
    btn.textContent = pilihan;
    btn.onclick = () => cekJawaban(pilihan);
    opsiJawaban.appendChild(btn);
  });
}


function cekJawaban(pilihan) {
  const soal = seluruhSoal[indexSoal];
  const benar = pilihan === soal.jawaban;
  if (benar) skor++;
  jawabanUser.push({ soal: indexSoal + 1, benar });

  document.getElementById("feedback").innerHTML = `<b>${benar ? "Benar!" : "Salah."}</b> ${soal.penjelasan}`;
  document.querySelectorAll(".btn-option").forEach(btn => btn.disabled = true);

  const btnLanjut = document.getElementById("btnLanjut");
  btnLanjut.style.display = "inline-block";

  if (indexSoal === seluruhSoal.length - 1) {
    btnLanjut.textContent = "Kuis selesai, klik untuk melihat skor kamu";
  } else {
    btnLanjut.textContent = "Soal Berikutnya";
  }
}

function lanjutSoal() {
  indexSoal++;
  if (indexSoal < seluruhSoal.length) {
    tampilkanSoal();
  } else {
    selesaikanKuis();
  }
}

function selesaikanKuis() {
  document.getElementById("soalContainer").style.display = "none";
  document.getElementById("hasilContainer").style.display = "block";
  document.getElementById("skorAkhir").textContent = `Kamu menjawab benar ${skor} dari 12 soal`;
  document.getElementById("pesanHasil").textContent =
    skor === 12 ? "üéâ Hebat! Kamu menjawab semua soal dengan benar!" : "Yuk coba lagi biar lebih jago! üí™";

  // Tampilkan atau sembunyikan tombol "Coba Lagi"
  const btnCobaLagi = document.getElementById("btnCobaLagi");
  btnCobaLagi.style.display = skor === 12 ? "none" : "inline-block";

  // Simpan skor ke Firebase
  const nama = document.getElementById("nama").value.trim();
  const sekolah = document.getElementById("sekolah").value.trim();
  const userId = `${nama.toLowerCase()}_${sekolah.toLowerCase()}`;
  db.ref(`kuis/${userId}`).set({
    nama,
    sekolah,
    skor,
    waktu: new Date().toISOString()
  });
}


function cobaLagi() {
  indexSoal = 0;
  skor = 0;
  jawabanUser = [];
  seluruhSoal = [...acakArray(soalMudah), ...acakArray(soalSedang), ...acakArray(soalSulit)];
  document.getElementById("hasilContainer").style.display = "none";
  document.getElementById("soalContainer").style.display = "block";
  document.getElementById("btnLanjut").style.display = "none";
  document.getElementById("infoLevel").classList.remove("d-none");
  tampilkanSoal();
}


function showNotification(pesan, tipe = "info") {
  const warna = {
    info: "#0275d8",
    success: "#5cb85c",
    warning: "#f0ad4e",
    danger: "#d9534f"
  };
  const notif = document.createElement("div");
  notif.className = `alert alert-${tipe} mx-auto mt-3 w-75 text-center shadow`;
  notif.style.backgroundColor = warna[tipe] || warna.info;
  notif.style.color = "white";
  notif.textContent = pesan;

  document.getElementById("notifArea").appendChild(notif);
  setTimeout(() => notif.remove(), 4000);
}

 const music = document.getElementById('bg-music');
  const toggleBtn = document.getElementById('music-toggle');
  const icon = document.getElementById('music-icon');
  const toast = document.getElementById('music-toast');

  function updateIcon() {
    icon.textContent = music.paused ? 'üîá' : 'üîä';
  }

  function showToast(message) {
    toast.textContent = message;
    toast.style.display = 'block';
    toast.style.opacity = '1';
    setTimeout(() => {
      toast.style.opacity = '0';
      setTimeout(() => (toast.style.display = 'none'), 500);
    }, 2000);
  }

  toggleBtn.addEventListener('click', () => {
    if (music.paused) {
      music.play().then(() => {
        updateIcon();
        showToast('Musik Dinyalakan');
      }).catch(() => {});
    } else {
      music.pause();
      updateIcon();
      showToast('Musik Dimatikan');
    }
  });

  // Autoplay fix: play after first interaction if needed
  document.addEventListener('DOMContentLoaded', () => {
    const tryPlay = () => {
      if (music.paused) {
        music.play().then(updateIcon).catch(() => {});
      } else {
        updateIcon();
      }
      document.body.removeEventListener('click', tryPlay);
    };
    document.body.addEventListener('click', tryPlay);
  });
  AOS.init();
  </script>
</body>
</html>
